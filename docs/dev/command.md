# 命令

Echo-Live 的编辑器中提供了控制台和命令系统以供您使用特定功能。

在编辑器中按下 <kbd>Ctrl</kbd> + <kbd>/</kbd> 组合键可以开启/关闭控制台。当控制台开启时也可以通过按下 <kbd>Esc</kbd> 键关闭控制台，以此方法关闭控制台不会保留控制台中输入的内容。

在控制台中按下 <kbd>↵ Enter</kbd> 键可以执行命令，按下 <kbd>Ctrl</kbd> + <kbd>↵ Enter</kbd> 组合键可以回车，编写多行内容。

## 命令指南

Echo-Live 的命令以命令关键词作为开头，使用空格分隔绝大多数参数（不包括部分接受任意文本的参数，空格也会被视为参数的一部分）。

### 语法表示

| 输入项 | 含义 |
| - | - |
| `字面量` | 按**原样**输入的内容。 |
| `<参数>` | 需使用一合适的值来替换的参数。 |

| 修饰符 | 含义 |
| - | - |
| `[输入项]` | 该输入项是**可选**的。 |
| `(输入项|输入项)` | 必选，选择其中**一个**输入项填写。 |
| `[输入项|输入项]` | 可选，选择其中**一个**输入项填写。 |
| `省略号 ...` | 省略了一些必选的部分。 |

例如，`[<text>]` 是可选的参数，而 `[text]` 是可选的字面量。

### 限制条件

一些命令执行时要求满足特定条件。

- :material-broadcast: **仅限广播模式**：一些命令需要使用广播才能正常运作。
- :material-console-line: **函数中不可用**：一些命令仅供调试使用，不可在函数中执行，只能通过控制台执行。

### 结果

尝试执行命令后会产生不同的效结果，包括无法解析、执行失败、执行成功等。

#### 无法解析

若输入的命令不完整，或存在无法解析的参数，该命令就无法解析。

#### 执行失败和执行成功

若输入的命令格式正确，则会有执行失败和执行成功两种结果。

执行失败通常是因为命令受限制条件影响无法执行。

请注意，并非所有的 “执行成功” 的命令都会有所改变，“执行失败” 的命令也不意味着命令什么也没有做。

### 变量

使用 [`var`](command/var.md) 命令设置的变量可以通过 `@<变量名>` 引用，当命令中存在变量引用时，优先进行替换引用，然后再执行命令。

例如 `say @message` 这条命令中引用了名为 `message` 的变量，假设该变量值为 `Hello, world!`，则实际执行的命令为 `say Hello, world!`。

### 堆栈

当命令通过函数执行时，会为该函数创建独立的本地堆栈，在该堆栈中使用 [`var`](command/var.md) 命令设置的变量不会影响到其他堆栈中设置的变量。当全局堆栈和本地堆栈中存在相同名称的变量时，优先使用本地堆栈中的变量进行替换引用。

当函数的生命周期结束时，其本地堆栈会被销毁。

### 函数

函数是一种一次性执行多条命令的机制。在编辑器控制台中，可以输入以 `//` 开头的内容启用函数模式。同时，`//` 也是函数中的注释标识符，如果输入的内容包含非注释内容也将会一并执行。

进入函数模式后，按键将有所变化。回车改为 <kbd>↵ Enter</kbd>，执行命令改为 <kbd>Ctrl</kbd> + <kbd>↵ Enter</kbd>。

要退出函数模式，输入 `//` 且不包含其他内容按下 <kbd>Ctrl</kbd> + <kbd>↵ Enter</kbd> 组合键即可退出。

#### 注释

函数中可以使用注释来备注一些命令，注释中的内容不会被当作命令执行。

注释仅可出现在行首，以 `//` 开头。以下是一段在函数中使用注释的示例：

```
// 这是一个简单的 HelloWorld
var a = Hello, World!
say @a
```

## 命令列表

| 命令 | 描述 | :material-broadcast: 仅广播 | :material-console-line: 函数禁用 |
| - | - | - | - |
| [`clearlocalstorage`](command/clearlocalstorage.md) | 清空本地存储数据，需要弹出对话框确认。 | | 是 |
| [`getlang`](command/getlang.md) | 获取当前所使用的本地化信息。 | | |
| [`livedisplay`](command/livedisplay.md) | 设置对话框显示状态。 | 是 | |
| [`next`](command/next.md) | 发送 [`echo_next`](broadcast/api/echo_next.md) 广播，打印下一条消息。 | 是 | |
| [`ping`](command/ping.md) | 发送 [`ping`](broadcast/api/ping.md) 广播。 | 是 | |
| [`say`](command/say.md) | 在日志中输出一段消息。 | | |
| [`shutdown`](command/shutdown.md) | 发送 [`shutdown`](broadcast/api/shutdown.md) 广播，终止客户端运行。 | 是 | |
| [`theme`](command/theme.md) | 发送 [`set_theme`](broadcast/api/set_theme.md) 广播，更改客户端主题。 | 是 | |
| [`var`](command/var.md) | 设置变量，可在命令中通过 `@<变量名>` 使用。 | | |
| [`varg`](command/varg.md) | 在全局堆栈中设置变量。 | | |